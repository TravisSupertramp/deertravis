var butter={initialize:function(){this.polyfill(),i18n.init({fallbackLng:"en"},function(){$("html").i18n()})},polyfill:function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;b++)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"]},detectUA:function(a,b){return/Mac/.test(a)?"mac":/Win/.test(a)?"win":/Android/.test(b)?"android":/Lin/.test(a)?/x86_64/.test(a)?"lin-64":"lin-32":void 0},getAndroidVersion:function(){$.get("https://ci.butterproject.org/android/mobile/release",function(a){var b=a.mobile.release["armeabi-v7a"].versionName,c="https://get.butterproject.org/android/"+b+"/mobile-armeabi-v7a-release-"+b+".apk";0==b.indexOf("0")&&(b=b.substring(2,b.length)),$('a[data-os="Android"]').attr("href",c).html(i18n.t("download.text",{defaultValue:"Download Beta %s",postProcess:"sprintf",sprintf:[b]}))},"json")},updateDownloads:function(a,b){document.body.className+=" "+(this.detectUA(a,b)||"nope")},updateStatus:function(a,b){$.get(b,function(b){$(a).addClass(b.status.indicator)},"json")},smoothScroll:function(){$("a[data-scroll][href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var a=$(this.hash);if(a=a.length?a:$("[name="+this.hash.slice(1)+"]"),a.length)return $("html,body").animate({scrollTop:a.offset().top},800),!1}})},snow:function(){function a(){e=document.getElementById("header"),w=e.offsetWidth,h=e.offsetHeight,halfWidth=w/2,c.width=w,c.height=h}function b(){d.clearRect(0,0,w,h),t+=.01,draw=!0;for(var a=L.length-1;a>=0;a--)Math.sin(L[a][0])<0&&(p=L[a][1],q=Math.cos(L[a][0])*L[a][2]+275,u=30*(9*t-a%1e3),q+=u*=u>0,p+=u*Math.cos(u/500)/9+.4,d.fillStyle="rgba("+~~L[a][9]+","+~~L[a][10]+","+~~L[a][11]+",0.8)",d.beginPath(),v1x=L[a][3]*Math.cos(u/60)+q,v1y=L[a][4]*Math.cos(u/44)+p,v2x=L[a][5]*Math.cos(u/60)+q,v2y=L[a][6]*Math.cos(u/44)+p,v3x=L[a][7]*Math.cos(u/60)+q,v3y=L[a][8]*Math.cos(u/44)+p,d.moveTo(v1x,v1y),d.lineTo(v2x,v2y),d.lineTo(v3x,v3y),d.closePath(),d.fill());for(a=B.length;a--;)a%2?d.lineWidth=B[(d.beginPath(),a)][(d.moveTo(Math.cos(B[a][0])*B[a][2]+275,B[a][1]),3)]:(d.lineTo(Math.cos(B[a][0])*B[a][2]+275,B[a][1]),d.stroke());for(var a=L.length-1;a>=0;a--)Math.sin(L[a][0])<0&&(p=L[a][1],q=Math.cos(L[a][0])*L[a][2]+275,u=30*(9*t-a%1e3)+300,q+=u*=u>0,p+=u*Math.cos(u/300)/9+.4,d.fillStyle="rgba("+~~L[a][9]+","+~~L[a][10]+","+~~L[a][11]+",0.8)",d.beginPath(),v1x=L[a][3]*Math.cos(u/60)+q,v1y=L[a][4]*Math.cos(u/44)+p,v2x=L[a][5]*Math.cos(u/60)+q,v2y=L[a][6]*Math.cos(u/44)+p,v3x=L[a][7]*Math.cos(u/60)+q,v3y=L[a][8]*Math.cos(u/44)+p,d.moveTo(v1x,v1y),d.lineTo(v2x,v2y),d.lineTo(v3x,v3y),d.closePath(),d.fill());draw&&requestAnimationFrame(b)}var c=(Math.PI,document.createElement("canvas")),d=c.getContext("2d");c.className="tree";var e=document.getElementById("header");e.insertBefore(c,e.childNodes[0]),w=e.offsetWidth,h=e.offsetHeight;t=-.4,B=[],L=[],G=function(a,b,c,d,e){for(var f=0;3>f;++f)L.push([a+Math.random()/9,b+30*Math.random()-15,c+30*Math.random()-15,40*Math.random()-20,40*Math.random()-20,40*Math.random()-20,40*Math.random()-20,40*Math.random()-20,40*Math.random()-20,40*Math.random()*5+40,40*Math.random()*5+40,40*Math.random()]);if(6>d)for(B.push([a,b,c],[a+=2*Math.random()-1+(2==d)*e,b-=Math.random()*h/8+20-c/5,c+=25*Math.random()*e-5,12-2*d]),e=3;e--;)G(a,b,c,d+1,2*e)},G(9,5*h/6,20,1,0),a(),window.requestAnimationFrame(b)},explode:function(){function a(a,b){return Math.floor(Math.random()*(b-a+1))+a}function b(a,b){return Math.random()*(b-a)+a}var c=0,d=document.createElement("canvas");d.className="explosion";var e=document.getElementById("header");e.insertBefore(d,e.childNodes[0]);var f=e.offsetWidth,g=e.offsetHeight;d.width=f,d.height=g;var h,i,j,k,l,m,n=1,o=1,p=1,q=0,r=0,s=0,t=0,u=d.getContext("2d"),v=new Image;v.src="../images/bg-header-tr.png",v.onload=function(){function w(){for(var c=0;c<D.data.length;c+=4)if(0!=D.data[c+3]){var d=c/4%f,e=Math.floor(c/4/f);D.data[c+3]>200&&E.push([d,e,D.data[c],D.data[c+1],D.data[c+2],D.data[c+3]]),D.data[c]=255,D.data[c+1]=0,D.data[c+2]=0,D.data[c+3]=255}for(var c=0;c<E.length;c+=100)for(var g=0;1>g;g++){var d=E[c][0],e=E[c][1],h=20,i=a(d-h,d-1),j=a(e-h,e+h),k=d,m=e,n=a(d+1,d+h),o=a(e-h,e+h),p=E[c][2],q=E[c][3],r=E[c][4],s=E[c][5],t=b(.65,.72),u=b(200,300),v=b(100,150),w=30*Math.random()+1;F.push({v1x:i,v1y:j,v2x:k,v2y:m,v3x:n,v3y:o,red:p,green:q,blue:r,alpha:s,angle:t,speed:u,accel:v,timeToGo:w,scale:l}),G.push({v1x:i,v1y:j,v2x:k,v2y:m,v3x:n,v3y:o,red:p,green:q,blue:r,alpha:s,angle:t,speed:u,accel:v,timeToGo:w,scale:l})}}function x(){u.clearRect(0,0,f,g),y(G),z(),window.requestAnimationFrame(x)}function y(a){for(var b=0;b<a.length;b++)tile=a[b],u.fillStyle="rgba("+tile.red+","+tile.green+","+tile.blue+",0.8)",u.beginPath(),u.moveTo(tile.v1x,tile.v1y),u.lineTo(tile.v2x,tile.v2y),u.lineTo(tile.v3x,tile.v3y),u.closePath(),u.fill()}function z(){var a=.01;c+=a;for(var b=0;b<G.length;b++)tileOrig=F[b],tile=G[b],tileOrig.timeToGo<=c?(tile.v1x=tileOrig.v1x+(c-tileOrig.timeToGo)*tileOrig.speed,tile.v1y=tileOrig.v1y-Math.sin((c-tileOrig.timeToGo)*tileOrig.angle)*(512*tileOrig.angle),tile.v2x=tileOrig.v2x+(c-tileOrig.timeToGo)*tileOrig.speed,tile.v2y=tileOrig.v2y-Math.sin((c-tileOrig.timeToGo)*tileOrig.angle)*(512*tileOrig.angle)+25*Math.sin(40*(c-tileOrig.timeToGo)),tile.v3x=tileOrig.v3x+(c-tileOrig.timeToGo)*tileOrig.speed,tile.v3y=tileOrig.v3y-Math.sin((c-tileOrig.timeToGo)*tileOrig.angle)*(512*tileOrig.angle)):(tile.v1x=tileOrig.v1x,tile.v1y=tileOrig.v1y,tile.v2x=tileOrig.v2x,tile.v2y=tileOrig.v2y,tile.v3x=tileOrig.v3x,tile.v3y=tileOrig.v3y)}function A(){e=document.getElementById("header"),f=e.offsetWidth,g=e.offsetHeight,d.width=f,d.height=g,C(),B()}function B(){for(var a=0;a<F.length;a++)tile=F[a],h>i?(tile.v1x=tile.v1x*m+0,tile.v1y=tile.v1y*m+0,tile.v2x=tile.v2x*m+0,tile.v2y=tile.v2y*m+0,tile.v3x=tile.v3x*m+0,tile.v3y=tile.v3y*m+0):(tile.v1x=tile.v1x*m+q-r,tile.v1y=tile.v1y*m+s,tile.v2x=tile.v2x*m+q-r,tile.v2y=tile.v2y*m+s,tile.v3x=tile.v3x*m+q-r,tile.v3y=tile.v3y*m+s)}function C(){h=f/imgW,i=g/imgH,j=h/n,k=i/o,n=h,o=i,h>i?(l=h,t=s,s=0):(l=i,r=q,q=(f-imgW*l)/2),m=l/p,p=l}imgW=v.width,imgH=v.height,C(),u.drawImage(v,q,0,l*imgW,l*imgH);var D=u.getImageData(0,0,f,g),E=[],F=[],G=[];w(),window.addEventListener("resize",A),window.requestAnimationFrame(x)}}};butter.initialize(),butter.smoothScroll(),11===(mnth=(new Date).getMonth())||0===mnth,butter.explode();